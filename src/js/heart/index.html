<section class="content clearfix" data-bind="css: {'drawer-in': allIssuesVisible}">

    <button type="button" class="btn--icon btn--settings" data-bind="click: openCredentialsDialog">
        <span class="fa fa-gear fa-lg"></span>
    </button>

    <div class="subcontent--drawer">
        <button type="button" class="btn--icon btn--toggle">
            <span class="fa fa-chevron-right hide--drawer-in" title="See all open issues" data-bind="click: allIssuesVisible.bind($data, true)"></span>
            <span class="fa fa-times hide--drawer-out"  title="Hide all open issues" data-bind="click: allIssuesVisible.bind($data, false)"></span>
        </button>
        <h4 class="subheader">
            <a class="subheader__link" href="https://github.com/ordoro/ordoro/issues" target="_blank">Open Issues</a>
        </h4>
        <input type="text" class="text-input search" data-bind="value: allIssuesSearch, valueUpdate: 'input'">
        <ul class="list list--drawer connected-sortable" data-bind="sortable: {data: allIssues, connectClass: 'connected-sortable', afterMove: issueRemovedFromMilestone}">
            <li class="list__item">
                <a data-bind="attr: {href: htmlURL}" target="_blank">
                    <strong class="make-block" data-bind="text: number"></strong>
                    <span data-bind="text: title"></span>
                </a>
                <ul class="list--tags">
                    <li class="list__item--tag" style="background-color: #02d7e1"></li>
                    <li class="list__item--tag" style="background-color: #d7e102"></li>
                    <li class="list__item--tag" style="background-color: #dddddd"></li>
                    <li class="list__item--tag" style="background-color: #d7e102"></li>
                    <li class="list__item--tag" style="background-color: #fad8c7"></li>
                    <li class="list__item--tag" style="background-color: #e10c02"></li>
                    <li class="list__item--tag" style="background-color: #d4c5f9"></li>
                    <li class="list__item--tag" style="background-color: #12eb45"></li>
                </ul>
                <!-- ko if: assignee -->
                <button type="button" class="btn--avatar">
                    <img class="img--avatar" data-bind="attr: {src: assignee().avatarURL}">
                </button>
                <!-- /ko -->
            </li>
        </ul>
    </div>
    <!-- NEED TO HAVE THIS DIV AUTOMATICALLY RESIZE LIKE TRELLO CONTAINTER DOES -->
    <div class="subcontent-wrap--outer" style="height: 800px">
        <div class="subcontent-wrap">
            <!-- ko foreach: milestones -->
            <div class="subcontent">
                <h4 class="subheader">
                    <a class="subheader__link" data-bind="text: title, attr: {href: url}" target="_blank"></a>
                </h4>
                <ul class="list connected-sortable" data-bind="sortable: {data: issueViews, connectClass: 'connected-sortable', afterMove: $parent.issueMovedToMilestone.bind($parent)}">
                    <li class="list__item">
                        <a data-bind="attr: {href: htmlURL}" target="_blank">
                            <strong class="make-block" data-bind="text: number"></strong>
                            <span data-bind="text: title"></span>
                        </a>
                        <ul class="list--tags">
                            <li class="list__item--tag" style="background-color: #02d7e1"></li>
                            <li class="list__item--tag" style="background-color: #d7e102"></li>
                            <li class="list__item--tag" style="background-color: #dddddd"></li>
                            <li class="list__item--tag" style="background-color: #d7e102"></li>
                            <li class="list__item--tag" style="background-color: #fad8c7"></li>
                            <li class="list__item--tag" style="background-color: #e10c02"></li>
                            <li class="list__item--tag" style="background-color: #d4c5f9"></li>
                            <li class="list__item--tag" style="background-color: #12eb45"></li>
                        </ul>
                        <!-- ko if: assignee -->
                        <button type="button" class="btn--avatar">
                            <img class="img--avatar" data-bind="attr: {src: assignee().avatarURL}">
                            <span class="fa fa-times"  title="Unassign this user"></span>
                        </button>
                        <!-- /ko -->

                        <div class="popover-wrap" data-bind="css: {expanded: assignUserVisible}">
                            <button type="button" class="btn--popover" data-bind="click: $root.showAssignUser.bind($root, $parent)">Assign issue to...</button>
                            <!-- ko if: assignUserVisible -->
                            <div class="popover">
                                <div class="popover-inner">
                                    <ul class="popover-list">
                                        <!-- ko foreach: $root.users -->
                                        <li class="popover-list__item">
                                            <button class="btn--assign" data-bind="click: $parent.assignUser.bind($parent)">
                                                <span class="avatar make-inline-block">
                                                    <img class="img--avatar" data-bind="attr: {src: avatarURL}">
                                                </span>
                                                <span class="btn--assign-text" data-bind="text: login"></span>
                                            </button>
                                        </li>
                                        <!-- /ko -->
                                    </ul>
                                </div>
                            </div>
                            <!-- /ko -->
                        </div>
                    </li>
                </ul>
            </div>
            <!-- /ko -->
        </div>
    </div>
</section>

<div data-bind="template: {name: credentialsDialog.template, data: credentialsDialog}"></div>
